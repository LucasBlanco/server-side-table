{"version":3,"file":"index.modern.js","sources":["../src/datatable/localization.ts","../src/datatable/server-side.tsx","../src/index.tsx"],"sourcesContent":["export const localizationOptions = {\n  textLabels: {\n    body: {\n      noMatch: 'No se han encontrado registros que coincidan con la busqueda',\n      toolTip: 'Ordenar',\n      columnHeaderTooltip: (column: any) => `Orden para ${column.label}`\n    },\n    pagination: {\n      next: 'Proxima',\n      previous: 'Anterior',\n      rowsPerPage: 'Registros por pagina:',\n      displayRows: 'de'\n    },\n    toolbar: {\n      search: 'Buscar',\n      downloadCsv: 'Descargar CSV',\n      print: 'Imprimir',\n      viewColumns: 'Ver columnas',\n      filterTable: 'Filtrar tabla'\n    },\n    filter: {\n      all: 'Todos',\n      title: 'FILTROS',\n      reset: 'LIMPIAR'\n    },\n    viewColumns: {\n      title: 'Ver columnas',\n      titleAria: 'Ver/Ocultar columnas'\n    },\n    selectedRows: {\n      text: 'registro(s) seleccionado',\n      delete: 'Borrar',\n      deleteAria: 'Borrar columnas seleccionadas'\n    }\n  }\n}\n","import { debounceSearchRender, MUIDataTableState } from 'mui-datatables'\nimport { useEffect, useState } from 'react'\nimport { localizationOptions } from './localization'\n\ninterface ServerSidePaginatorInterface {\n  total: number\n  page: number\n  itemsPerPage: number\n}\ninterface OrderCriteria {\n  name: string\n  direction: 'asc' | 'desc'\n}\ntype ServerSideOrderFn = (x: OrderCriteria) => string\ninterface RequestFnResponse<T> {\n  data: T[]\n  total: number\n}\ntype ServerRequestFn<T> = (params: string) => Promise<RequestFnResponse<T>>\n\nexport const serverSidePaginator = (\n  { label, firstPageNro } = { label: 'page', firstPageNro: 1 }\n) => {\n  let paginatorInfo: ServerSidePaginatorInterface = {\n    total: 0,\n    page: firstPageNro,\n    itemsPerPage: 0\n  }\n\n  const isPageValid = (page: number) => {\n    const { itemsPerPage, total } = paginatorInfo\n    const noUnderflow = page >= firstPageNro\n    const noOverflow =\n      total > 0 && itemsPerPage > 0\n        ? Math.ceil(total / itemsPerPage) >= page\n        : true\n    return noUnderflow && noOverflow\n  }\n\n  const getPage = (page: number) => {\n    if (!isPageValid(page)) {\n      throw new Error(`page ${page} is invalid`)\n    }\n    paginatorInfo.page = page\n    return `${label}=${page}`\n  }\n\n  const nextPage = () => getPage(paginatorInfo.page + 1)\n\n  const previousPage = () => getPage(paginatorInfo.page - 1)\n\n  const firstPage = () => getPage(firstPageNro)\n\n  const lastPage = () =>\n    getPage(Math.ceil(paginatorInfo.total / paginatorInfo.itemsPerPage))\n\n  const setTotal = (total: number) => {\n    paginatorInfo.total = total\n  }\n\n  return {\n    nextPage,\n    previousPage,\n    firstPage,\n    lastPage,\n    getPage,\n    setTotal,\n    firstPageNro,\n    ...paginatorInfo\n  }\n}\n\nexport const serverSideFilter = (queryName: string) => (search: string) =>\n  `${queryName}=${search}`\n\nexport const serverSideOrder = (orderAdapter: ServerSideOrderFn) => (\n  orderCriteria: OrderCriteria\n) => orderAdapter(orderCriteria)\n\nexport const serverSideHandler = (params: {\n  paginator: ReturnType<typeof serverSidePaginator>\n  filter?: ReturnType<typeof serverSideFilter>\n  order?: (x: OrderCriteria) => string\n}) => {\n  let filterCache = ''\n  let orderCache = ''\n  let pageCache = ''\n\n  const createQuery = () =>\n    [pageCache, filterCache, orderCache].filter((x) => !!x).join('&')\n\n  const nextPage = () => {\n    pageCache = params.paginator.nextPage()\n    return createQuery()\n  }\n\n  const previousPage = () => {\n    pageCache = params.paginator.previousPage()\n    return createQuery()\n  }\n\n  const firstPage = () => {\n    pageCache = params.paginator.firstPage()\n    return createQuery()\n  }\n\n  const loadData = firstPage\n\n  const lastPage = () => {\n    pageCache = params.paginator.previousPage()\n    return createQuery()\n  }\n  const getPage = (nro: number) => {\n    pageCache = params.paginator.getPage(nro)\n    return createQuery()\n  }\n  const filter = (search: string) => {\n    filterCache = params.filter ? params.filter(search) : ''\n    return createQuery()\n  }\n  const order = (orderCriteria: OrderCriteria) => {\n    orderCache = params.order ? params.order(orderCriteria) : ''\n    return createQuery()\n  }\n  const reset = () => {\n    filterCache = ''\n    orderCache = ''\n    pageCache = ''\n  }\n\n  return {\n    paginator: {\n      ...params.paginator,\n      nextPage,\n      previousPage,\n      firstPage,\n      lastPage,\n      getPage\n    },\n    loadData,\n    filter,\n    order,\n    reset\n  }\n}\n\nexport const baseTableHandler = serverSideHandler({\n  paginator: serverSidePaginator(),\n  filter: serverSideFilter('filter'),\n  order: serverSideOrder(\n    ({ name, direction }) => `sortBy=${name}&orderBy=${direction}`\n  )\n})\n\nexport const useServerSide = function <T>(props: {\n  requestFn: ServerRequestFn<T>\n  tableHandler: ReturnType<typeof serverSideHandler>\n}) {\n  const [data, setData] = useState<T[]>([])\n  const [total, setTotal] = useState(0)\n  const { requestFn, tableHandler } = props\n\n  const loadData = (params: string) => {\n    const promise = requestFn(params)\n    const updateFn = (res: RequestFnResponse<T>) => {\n      tableHandler.paginator.setTotal(res.total)\n      setData(res.data)\n      setTotal(res.total)\n    }\n    promise.then(updateFn)\n  }\n\n  const reload = () => {\n    const { getPage, page } = tableHandler.paginator\n    loadData(getPage(page))\n  }\n\n  const serverSideOptions = {\n    serverSide: true,\n    filter: false,\n    count: total,\n    customSearchRender: debounceSearchRender(500),\n    onTableChange: (action: string, tableState: MUIDataTableState) => {\n      if (action !== 'sort' && action !== 'search' && action !== 'changePage') {\n        return\n      }\n      tableHandler.reset()\n      if (Object.keys(tableState.sortOrder).length > 0) {\n        const { name, direction } = tableState.sortOrder\n        tableHandler.order({ name, direction })\n      }\n      if (tableState.searchText) {\n        tableHandler.filter(tableState.searchText)\n      }\n      loadData(\n        tableHandler.paginator.getPage(\n          tableHandler.paginator.firstPageNro + tableState.page\n        )\n      )\n    }\n  }\n\n  useEffect(() => loadData(tableHandler.paginator.firstPage()), []) // First Load\n\n  const customOptions = { ...serverSideOptions, ...localizationOptions }\n\n  return {\n    data,\n    serverSideProps: { options: customOptions },\n    reload\n  }\n}\n","import * as React from 'react'\nimport styles from './styles.module.css'\nimport {\n  useServerSide,\n  serverSideOrder,\n  serverSidePaginator,\n  serverSideHandler,\n  serverSideFilter\n} from './datatable/server-side'\nimport { localizationOptions } from './datatable/localization'\n\ninterface Props {\n  text: string\n}\n\nexport {\n  useServerSide,\n  serverSideOrder,\n  serverSidePaginator,\n  serverSideHandler,\n  serverSideFilter,\n  localizationOptions\n}\n\nexport const ExampleComponent = ({ text }: Props) => {\n  return <div className={styles.test}>Example: {text}</div>\n}\n"],"names":["localizationOptions","textLabels","body","noMatch","toolTip","columnHeaderTooltip","column","label","pagination","next","previous","rowsPerPage","displayRows","toolbar","search","downloadCsv","print","viewColumns","filterTable","filter","all","title","reset","titleAria","selectedRows","text","deleteAria","serverSidePaginator","firstPageNro","paginatorInfo","total","page","itemsPerPage","isPageValid","noUnderflow","noOverflow","Math","ceil","getPage","Error","nextPage","previousPage","firstPage","lastPage","setTotal","serverSideFilter","queryName","serverSideOrder","orderAdapter","orderCriteria","serverSideHandler","params","filterCache","orderCache","pageCache","createQuery","x","join","paginator","loadData","nro","order","baseTableHandler","name","direction","useServerSide","props","useState","data","setData","requestFn","tableHandler","promise","updateFn","res","then","reload","serverSideOptions","serverSide","count","customSearchRender","debounceSearchRender","onTableChange","action","tableState","Object","keys","sortOrder","length","searchText","useEffect","customOptions","serverSideProps","options","ExampleComponent","React","className","styles","test"],"mappings":"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"}