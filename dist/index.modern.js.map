{"version":3,"file":"index.modern.js","sources":["../src/datatable/localization.ts","../src/datatable/server-side.tsx","../src/index.tsx"],"sourcesContent":["export const localizationOptions = {\n  textLabels: {\n    body: {\n      noMatch: 'No se han encontrado registros que coincidan con la busqueda',\n      toolTip: 'Ordenar',\n      columnHeaderTooltip: (column: any) => `Orden para ${column.label}`\n    },\n    pagination: {\n      next: 'Proxima',\n      previous: 'Anterior',\n      rowsPerPage: 'Registros por pagina:',\n      displayRows: 'de'\n    },\n    toolbar: {\n      search: 'Buscar',\n      downloadCsv: 'Descargar CSV',\n      print: 'Imprimir',\n      viewColumns: 'Ver columnas',\n      filterTable: 'Filtrar tabla'\n    },\n    filter: {\n      all: 'Todos',\n      title: 'FILTROS',\n      reset: 'LIMPIAR'\n    },\n    viewColumns: {\n      title: 'Ver columnas',\n      titleAria: 'Ver/Ocultar columnas'\n    },\n    selectedRows: {\n      text: 'registro(s) seleccionado',\n      delete: 'Borrar',\n      deleteAria: 'Borrar columnas seleccionadas'\n    }\n  }\n}\n","import { debounceSearchRender, MUIDataTableState } from 'mui-datatables'\nimport { useEffect, useState } from 'react'\nimport { localizationOptions } from './localization'\n\ninterface ServerSidePaginatorInterface {\n  total: number\n  page: number\n  itemsPerPage: number\n}\ninterface OrderCriteria {\n  name: string\n  direction: 'asc' | 'desc'\n}\ntype ServerSideOrderFn = (x: OrderCriteria) => string\ninterface RequestFnResponse<T> {\n  data: T[]\n  total: number\n}\ntype ServerRequestFn<T> = (params: string) => Promise<RequestFnResponse<T>>\n\nexport const serverSidePaginator = (\n  { label, firstPageNro } = { label: 'page', firstPageNro: 1 }\n) => {\n  let paginatorInfo: ServerSidePaginatorInterface = {\n    total: 0,\n    page: firstPageNro,\n    itemsPerPage: 0\n  }\n\n  const isPageValid = (page: number) => {\n    const { itemsPerPage, total } = paginatorInfo\n    const noUnderflow = page >= firstPageNro\n    const noOverflow =\n      total > 0 && itemsPerPage > 0\n        ? Math.ceil(total / itemsPerPage) >= page\n        : true\n    return noUnderflow && noOverflow\n  }\n\n  const getPage = (page: number) => {\n    if (!isPageValid(page)) {\n      throw new Error(`page ${page} is invalid`)\n    }\n    paginatorInfo.page = page\n    return `${label}=${page}`\n  }\n\n  const nextPage = () => getPage(paginatorInfo.page + 1)\n\n  const previousPage = () => getPage(paginatorInfo.page - 1)\n\n  const firstPage = () => getPage(firstPageNro)\n\n  const lastPage = () =>\n    getPage(Math.ceil(paginatorInfo.total / paginatorInfo.itemsPerPage))\n\n  const setTotal = (total: number) => {\n    paginatorInfo.total = total\n  }\n\n  return {\n    nextPage,\n    previousPage,\n    firstPage,\n    lastPage,\n    getPage,\n    setTotal,\n    firstPageNro,\n    ...paginatorInfo\n  }\n}\n\nexport const serverSideFilter = (queryName: string) => (search: string) =>\n  `${queryName}=${search}`\n\nexport const serverSideOrder = (orderAdapter: ServerSideOrderFn) => (\n  orderCriteria: OrderCriteria\n) => orderAdapter(orderCriteria)\n\nexport const serverSideHandler = (params: {\n  paginator: ReturnType<typeof serverSidePaginator>\n  filter?: ReturnType<typeof serverSideFilter>\n  order?: (x: OrderCriteria) => string\n}) => {\n  let filterCache = ''\n  let orderCache = ''\n  let pageCache = ''\n\n  const createQuery = () =>\n    [pageCache, filterCache, orderCache].filter((x) => !!x).join('&')\n\n  const nextPage = () => {\n    pageCache = params.paginator.nextPage()\n    return createQuery()\n  }\n\n  const previousPage = () => {\n    pageCache = params.paginator.previousPage()\n    return createQuery()\n  }\n\n  const firstPage = () => {\n    pageCache = params.paginator.firstPage()\n    return createQuery()\n  }\n\n  const loadData = firstPage\n\n  const lastPage = () => {\n    pageCache = params.paginator.previousPage()\n    return createQuery()\n  }\n  const getPage = (nro: number) => {\n    pageCache = params.paginator.getPage(nro)\n    return createQuery()\n  }\n  const filter = (search: string) => {\n    filterCache = params.filter ? params.filter(search) : ''\n    return createQuery()\n  }\n  const order = (orderCriteria: OrderCriteria) => {\n    orderCache = params.order ? params.order(orderCriteria) : ''\n    return createQuery()\n  }\n  const reset = () => {\n    filterCache = ''\n    orderCache = ''\n    pageCache = ''\n  }\n\n  return {\n    paginator: {\n      ...params.paginator,\n      nextPage,\n      previousPage,\n      firstPage,\n      lastPage,\n      getPage\n    },\n    loadData,\n    filter,\n    order,\n    reset\n  }\n}\n\nexport const baseTableHandler = serverSideHandler({\n  paginator: serverSidePaginator(),\n  filter: serverSideFilter('filter'),\n  order: serverSideOrder(\n    ({ name, direction }) => `sortBy=${name}&orderBy=${direction}`\n  )\n})\n\nexport const useServerSide = function <T>(props: {\n  requestFn: ServerRequestFn<T>\n  tableHandler: ReturnType<typeof serverSideHandler>\n}) {\n  const [data, setData] = useState<T[]>([])\n  const [total, setTotal] = useState(0)\n  const { requestFn, tableHandler } = props\n\n  const loadData = (params: string) => {\n    const promise = requestFn(params)\n    const updateFn = (res: RequestFnResponse<T>) => {\n      tableHandler.paginator.setTotal(res.total)\n      setData(res.data)\n      setTotal(res.total)\n    }\n    promise.then(updateFn)\n  }\n\n  const reload = () => {\n    const { getPage, page } = tableHandler.paginator\n    loadData(getPage(page))\n  }\n\n  const serverSideOptions = {\n    serverSide: true,\n    filter: false,\n    count: total,\n    customSearchRender: debounceSearchRender(500),\n    onTableChange: (action: string, tableState: MUIDataTableState) => {\n      if (action !== 'sort' && action !== 'search' && action !== 'changePage') {\n        return\n      }\n      tableHandler.reset()\n      if (Object.keys(tableState.sortOrder).length > 0) {\n        const { name, direction } = tableState.sortOrder\n        tableHandler.order({ name, direction })\n      }\n      if (tableState.searchText) {\n        tableHandler.filter(tableState.searchText)\n      }\n      loadData(\n        tableHandler.paginator.getPage(\n          tableHandler.paginator.firstPageNro + tableState.page\n        )\n      )\n    }\n  }\n\n  useEffect(() => loadData(tableHandler.paginator.firstPage()), []) // First Load\n\n  const customOptions = { ...serverSideOptions, ...localizationOptions }\n\n  return {\n    data,\n    serverSideProps: { options: customOptions },\n    reload\n  }\n}\n","import * as React from 'react'\nimport styles from './styles.module.css'\nimport {\n  useServerSide,\n  serverSideOrder,\n  serverSidePaginator,\n  serverSideHandler,\n  serverSideFilter\n} from './datatable/server-side'\nimport { localizationOptions } from './datatable/localization'\n\ninterface Props {\n  text: string\n}\n\nexport {\n  useServerSide,\n  serverSideOrder,\n  serverSidePaginator,\n  serverSideHandler,\n  serverSideFilter,\n  localizationOptions\n}\n\nexport const ExampleComponent = ({ text }: Props) => {\n  return <div className={styles.test}>Example: {text}</div>\n}\n"],"names":["localizationOptions","textLabels","body","noMatch","toolTip","columnHeaderTooltip","column","label","pagination","next","previous","rowsPerPage","displayRows","toolbar","search","downloadCsv","print","viewColumns","filterTable","filter","all","title","reset","titleAria","selectedRows","text","delete","deleteAria","serverSidePaginator","firstPageNro","paginatorInfo","total","page","itemsPerPage","isPageValid","noUnderflow","noOverflow","Math","ceil","getPage","Error","nextPage","previousPage","firstPage","lastPage","setTotal","serverSideFilter","queryName","serverSideOrder","orderAdapter","orderCriteria","serverSideHandler","params","filterCache","orderCache","pageCache","createQuery","x","join","paginator","loadData","nro","order","useServerSide","props","data","setData","useState","requestFn","tableHandler","promise","updateFn","res","then","reload","serverSideOptions","serverSide","count","customSearchRender","debounceSearchRender","onTableChange","action","tableState","Object","keys","sortOrder","length","name","direction","searchText","useEffect","customOptions","serverSideProps","options","ExampleComponent","React","className","styles","test"],"mappings":"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"}