{"version":3,"file":"index.modern.js","sources":["../src/datatable/localization.ts","../src/datatable/server-side.tsx","../src/index.tsx"],"sourcesContent":["export const localizationOptions = {\n  textLabels: {\n    body: {\n      noMatch: 'No se han encontrado registros que coincidan con la busqueda',\n      toolTip: 'Ordenar',\n      columnHeaderTooltip: (column: any) => `Orden para ${column.label}`\n    },\n    pagination: {\n      next: 'Proxima',\n      previous: 'Anterior',\n      rowsPerPage: 'Registros por pagina:',\n      displayRows: 'de',\n      jumpToPage: 'Ir a la pagina'\n    },\n    toolbar: {\n      search: 'Buscar',\n      downloadCsv: 'Descargar CSV',\n      print: 'Imprimir',\n      viewColumns: 'Ver columnas',\n      filterTable: 'Filtrar tabla'\n    },\n    filter: {\n      all: 'Todos',\n      title: 'FILTROS',\n      reset: 'LIMPIAR'\n    },\n    viewColumns: {\n      title: 'Ver columnas',\n      titleAria: 'Ver/Ocultar columnas'\n    },\n    selectedRows: {\n      text: 'registro(s) seleccionado',\n      delete: 'Borrar',\n      deleteAria: 'Borrar columnas seleccionadas'\n    }\n  }\n}\n","import {\n  debounceSearchRender,\n  MUIDataTableOptions,\n  MUIDataTableState\n} from 'mui-datatables'\nimport { useEffect, useState } from 'react'\nimport { localizationOptions } from './localization'\n\ninterface ServerSidePaginatorInterface {\n  total: number\n  page: number\n  itemsPerPage: number\n}\ninterface OrderCriteria {\n  name: string\n  direction: 'asc' | 'desc'\n}\ntype ServerSideOrderFn = (x: OrderCriteria) => string\ninterface RequestFnResponse<T> {\n  data: T[]\n  total: number\n}\ntype ServerRequestFn<T> = (params: string) => Promise<RequestFnResponse<T>>\n\ninterface ServerSidePaginationProps {\n  label: string\n  firstPageNro: number\n  itemsPerPageLabel: string\n}\n\nexport const serverSidePaginator = (\n  props: ServerSidePaginationProps = {\n    label: 'page',\n    firstPageNro: 1,\n    itemsPerPageLabel: 'limit'\n  }\n) => {\n  const paginatorInfo: ServerSidePaginatorInterface = {\n    total: 0,\n    page: props.firstPageNro,\n    itemsPerPage: 10\n  }\n\n  const isPageValid = (page: number) => {\n    const { itemsPerPage, total } = paginatorInfo\n    const noUnderflow = page >= props.firstPageNro\n    const noOverflow =\n      total > 0 && itemsPerPage > 0\n        ? Math.ceil(total / itemsPerPage) >= page\n        : true\n    return noUnderflow && noOverflow\n  }\n\n  const getPage = (page: number) => {\n    if (!isPageValid(page)) {\n      throw new Error(`page ${page} is invalid`)\n    }\n    paginatorInfo.page = page\n    return `${props.label}=${page}&${props.itemsPerPageLabel}=${paginatorInfo.itemsPerPage}`\n  }\n\n  const nextPage = () => getPage(paginatorInfo.page + 1)\n\n  const previousPage = () => getPage(paginatorInfo.page - 1)\n\n  const firstPage = () => getPage(props.firstPageNro)\n\n  const lastPage = () =>\n    getPage(Math.ceil(paginatorInfo.total / paginatorInfo.itemsPerPage))\n\n  const setTotal = (total: number) => {\n    paginatorInfo.total = total\n  }\n\n  const setItemsPerPage = (amount: number) => {\n    paginatorInfo.itemsPerPage = amount\n  }\n\n  return {\n    nextPage,\n    previousPage,\n    firstPage,\n    lastPage,\n    getPage,\n    setTotal,\n    setItemsPerPage,\n    firstPageNro: props.firstPageNro,\n    ...paginatorInfo\n  }\n}\n\nexport const serverSideFilter = (queryName: string) => (search: string) =>\n  `${queryName}=${search}`\n\nexport const serverSideOrder = (orderAdapter: ServerSideOrderFn) => (\n  orderCriteria: OrderCriteria\n) => orderAdapter(orderCriteria)\n\nexport const serverSideHandler = (params: {\n  paginator: ReturnType<typeof serverSidePaginator>\n  filter?: ReturnType<typeof serverSideFilter>\n  order?: (x: OrderCriteria) => string\n}) => {\n  let filterCache = ''\n  let orderCache = ''\n  let pageCache = ''\n\n  const createQuery = () =>\n    [pageCache, filterCache, orderCache].filter((x) => !!x).join('&')\n\n  const nextPage = () => {\n    pageCache = params.paginator.nextPage()\n    return createQuery()\n  }\n\n  const previousPage = () => {\n    pageCache = params.paginator.previousPage()\n    return createQuery()\n  }\n\n  const firstPage = () => {\n    pageCache = params.paginator.firstPage()\n    return createQuery()\n  }\n\n  const loadData = firstPage\n\n  const lastPage = () => {\n    pageCache = params.paginator.previousPage()\n    return createQuery()\n  }\n  const getPage = (nro: number) => {\n    pageCache = params.paginator.getPage(nro)\n    return createQuery()\n  }\n  const filter = (search: string) => {\n    filterCache = params.filter ? params.filter(search) : ''\n    return createQuery()\n  }\n  const order = (orderCriteria: OrderCriteria) => {\n    orderCache = params.order ? params.order(orderCriteria) : ''\n    return createQuery()\n  }\n  const reset = () => {\n    filterCache = ''\n    orderCache = ''\n    pageCache = ''\n  }\n\n  return {\n    paginator: {\n      ...params.paginator,\n      nextPage,\n      previousPage,\n      firstPage,\n      lastPage,\n      getPage\n    },\n    loadData,\n    filter,\n    order,\n    reset\n  }\n}\n\nexport const baseTableHandler = serverSideHandler({\n  paginator: serverSidePaginator(),\n  filter: serverSideFilter('filter'),\n  order: serverSideOrder(\n    ({ name, direction }) => `sortBy=${name}&orderBy=${direction}`\n  )\n})\n\nexport const useServerSide = function <T>(props: {\n  requestFn: ServerRequestFn<T>\n  tableHandler: ReturnType<typeof serverSideHandler>\n}) {\n  const [data, setData] = useState<T[]>([])\n  const [total, setTotal] = useState(0)\n  const { requestFn, tableHandler } = props\n\n  const loadData = (params: string) => {\n    const promise = requestFn(params)\n    const updateFn = (res: RequestFnResponse<T>) => {\n      tableHandler.paginator.setTotal(res.total)\n      setData(res.data)\n      setTotal(res.total)\n    }\n    promise.then(updateFn)\n  }\n\n  const reload = () => {\n    const { getPage, page } = tableHandler.paginator\n    loadData(getPage(page))\n  }\n\n  const serverSideOptions: MUIDataTableOptions = {\n    serverSide: true,\n    filter: false,\n    count: total,\n    jumpToPage: true,\n    rowsPerPageOptions: [10, 20, 50, 100],\n    customSearchRender: debounceSearchRender(500),\n    onTableChange: (action: string, tableState: MUIDataTableState) => {\n      if (\n        action !== 'sort' &&\n        action !== 'search' &&\n        action !== 'changePage' &&\n        action !== 'changeRowsPerPage'\n      ) {\n        return\n      }\n      tableHandler.reset()\n      if (Object.keys(tableState.sortOrder).length > 0) {\n        const { name, direction } = tableState.sortOrder\n        tableHandler.order({ name, direction })\n      }\n      if (tableState.searchText) {\n        tableHandler.filter(tableState.searchText)\n      }\n      tableHandler.paginator.setItemsPerPage(tableState.rowsPerPage)\n      loadData(\n        tableHandler.paginator.getPage(\n          tableHandler.paginator.firstPageNro + tableState.page\n        )\n      )\n    }\n  }\n\n  useEffect(() => loadData(tableHandler.paginator.firstPage()), []) // First Load\n\n  const customOptions: MUIDataTableOptions = {\n    ...serverSideOptions,\n    ...localizationOptions\n  }\n\n  return {\n    data,\n    serverSideProps: { options: customOptions },\n    reload\n  }\n}\n","import * as React from 'react'\nimport styles from './styles.module.css'\nimport {\n  useServerSide,\n  serverSideOrder,\n  serverSidePaginator,\n  serverSideHandler,\n  serverSideFilter\n} from './datatable/server-side'\nimport { localizationOptions } from './datatable/localization'\n\ninterface Props {\n  text: string\n}\n\nexport {\n  useServerSide,\n  serverSideOrder,\n  serverSidePaginator,\n  serverSideHandler,\n  serverSideFilter,\n  localizationOptions\n}\n\nexport const ExampleComponent = ({ text }: Props) => {\n  return <div className={styles.test}>Example: {text}</div>\n}\n"],"names":["localizationOptions","textLabels","body","noMatch","toolTip","columnHeaderTooltip","column","label","pagination","next","previous","rowsPerPage","displayRows","jumpToPage","toolbar","search","downloadCsv","print","viewColumns","filterTable","filter","all","title","reset","titleAria","selectedRows","text","delete","deleteAria","serverSidePaginator","props","firstPageNro","itemsPerPageLabel","paginatorInfo","total","page","itemsPerPage","isPageValid","noUnderflow","noOverflow","Math","ceil","getPage","Error","nextPage","previousPage","firstPage","lastPage","setTotal","setItemsPerPage","amount","serverSideFilter","queryName","serverSideOrder","orderAdapter","orderCriteria","serverSideHandler","params","filterCache","orderCache","pageCache","createQuery","x","join","paginator","loadData","nro","order","useServerSide","data","setData","useState","requestFn","tableHandler","promise","updateFn","res","then","reload","serverSideOptions","serverSide","count","rowsPerPageOptions","customSearchRender","debounceSearchRender","onTableChange","action","tableState","Object","keys","sortOrder","length","name","direction","searchText","useEffect","customOptions","serverSideProps","options","ExampleComponent","React","className","styles","test"],"mappings":"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"}